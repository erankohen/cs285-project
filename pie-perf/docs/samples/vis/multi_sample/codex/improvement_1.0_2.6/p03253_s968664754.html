
<html>
<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <style>
        .container {
            display: flex;
            justify-content: space-between;
        }
        .code-block {
            padding: 10px;
            border-radius: 10px;
            width: 45%;
            background-color: #eaeaea;
            white-space: nowrap;
            overflow: hidden;
        }
        .diff-block-added {
            background-color: #a1f9a2;
            box-shadow: 0px 0px 3px 0px #60bd51;
            padding: 0px;
            border-radius: 10px;
            width: 45%;
        }
        .diff-block-removed {
            background-color: #fdd4d4;
            padding: 0px;
            border-radius: 10px;
            width: 45%;
            box-shadow: 0px 0px 3px 0px #ff7f7f;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="code-block">
            <p><strong>Slow Code:</strong></p>
            <p class="diff-block-removed">1. from&nbsp;math&nbsp;import&nbsp;floor,&nbsp;sqrt</p>
            <p class="diff-block-removed">2. from&nbsp;collections&nbsp;import&nbsp;defaultdict</p>
            <p class="diff-block-removed">3. </p>
            <p class="diff-block-removed">4. </p>
            <p class="diff-block-removed">5. def&nbsp;factors(n):</p>
            <p class="diff-block-removed">6. &nbsp;&nbsp;&nbsp;&nbsp;d&nbsp;=&nbsp;defaultdict(int)</p>
            <p class="diff-block-removed">7. &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(2,&nbsp;floor(sqrt(n))&nbsp;+&nbsp;1):</p>
            <p class="diff-block-removed">8. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;n&nbsp;%&nbsp;i&nbsp;==&nbsp;0:</p>
            <p class="diff-block-removed">9. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;n&nbsp;//=&nbsp;i</p>
            <p class="diff-block-removed">10. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d[i]&nbsp;+=&nbsp;1</p>
            <p class="diff-block-removed">11. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;==&nbsp;1:</p>
            <p class="diff-block-removed">12. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break</p>
            <p class="diff-block-removed">13. &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;n&nbsp;!=&nbsp;1:</p>
            <p class="diff-block-removed">14. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d[n]&nbsp;+=&nbsp;1</p>
            <p class="diff-block-removed">15. &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;d</p>
            <p class="diff-block-removed">16. </p>
            <p class="diff-block-removed">17. </p>
            <p class="diff-block-removed">18. def&nbsp;inv(x,&nbsp;mod):</p>
            <p class="diff-block-removed">19. &nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;=&nbsp;mod&nbsp;-&nbsp;2</p>
            <p class="diff-block-removed">20. &nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;1</p>
            <p class="diff-block-removed">21. &nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;k&nbsp;&gt;&nbsp;0:</p>
            <p class="diff-block-removed">22. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;k&nbsp;&amp;&nbsp;1:</p>
            <p class="diff-block-removed">23. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;(ret&nbsp;*&nbsp;x)&nbsp;%&nbsp;mod</p>
            <p class="diff-block-removed">24. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;=&nbsp;(x&nbsp;*&nbsp;x)&nbsp;%&nbsp;mod</p>
            <p class="diff-block-removed">25. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;k&nbsp;&gt;&gt;=&nbsp;1</p>
            <p class="diff-block-removed">26. &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ret</p>
            <p class="diff-block-removed">27. </p>
            <p class="diff-block-removed">28. </p>
            <p class="diff-block-removed">29. N,&nbsp;M&nbsp;=&nbsp;list(map(int,&nbsp;input().split()))</p>
            <p class="diff-block-removed">30. mod&nbsp;=&nbsp;10**9&nbsp;+&nbsp;7</p>
            <p class="diff-block-removed">31. dic&nbsp;=&nbsp;factors(M)</p>
            <p class="diff-block-removed">32. K&nbsp;=&nbsp;len(dic)</p>
            <p class="diff-block-removed">33. SIZE&nbsp;=&nbsp;N&nbsp;+&nbsp;max(dic.values())&nbsp;if&nbsp;list(dic.values())&nbsp;else&nbsp;N</p>
            <p class="diff-block-removed">34. fact&nbsp;=&nbsp;[None]&nbsp;*&nbsp;(SIZE&nbsp;+&nbsp;1)</p>
            <p class="diff-block-removed">35. finv&nbsp;=&nbsp;[None]&nbsp;*&nbsp;(SIZE&nbsp;+&nbsp;1)</p>
            <p class="diff-block-removed">36. fact[0]&nbsp;=&nbsp;1</p>
            <p class="diff-block-removed">37. for&nbsp;i&nbsp;in&nbsp;range(1,&nbsp;SIZE&nbsp;+&nbsp;1):</p>
            <p class="diff-block-removed">38. &nbsp;&nbsp;&nbsp;&nbsp;fact[i]&nbsp;=&nbsp;(fact[i&nbsp;-&nbsp;1]&nbsp;*&nbsp;i)&nbsp;%&nbsp;mod</p>
            <p class="diff-block-removed">39. finv[SIZE]&nbsp;=&nbsp;inv(fact[SIZE],&nbsp;mod=mod)</p>
            <p class="diff-block-removed">40. for&nbsp;i&nbsp;in&nbsp;range(SIZE,&nbsp;0,&nbsp;-1):</p>
            <p class="diff-block-removed">41. &nbsp;&nbsp;&nbsp;&nbsp;finv[i&nbsp;-&nbsp;1]&nbsp;=&nbsp;(finv[i]&nbsp;*&nbsp;i)&nbsp;%&nbsp;mod</p>
            <p class="diff-block-removed">42. </p>
            <p class="diff-block-removed">43. </p>
            <p class="diff-block-removed">44. def&nbsp;comb(n,&nbsp;k):</p>
            <p class="diff-block-removed">45. &nbsp;&nbsp;&nbsp;&nbsp;tmp&nbsp;=&nbsp;(finv[k]&nbsp;*&nbsp;finv[n&nbsp;-&nbsp;k])&nbsp;%&nbsp;mod</p>
            <p class="diff-block-removed">46. &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(fact[n]&nbsp;*&nbsp;tmp)&nbsp;%&nbsp;mod</p>
            <p class="diff-block-removed">47. </p>
            <p class="diff-block-removed">48. </p>
            <p>49. ans&nbsp;=&nbsp;1</p>
            <p class="diff-block-removed">50. for&nbsp;p&nbsp;in&nbsp;dic:</p>
            <p class="diff-block-removed">51. &nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;=&nbsp;(ans&nbsp;*&nbsp;comb(dic[p]&nbsp;+&nbsp;N&nbsp;-&nbsp;1,&nbsp;dic[p]))&nbsp;%&nbsp;mod</p>
            <p>52. print(ans)</p>
        </div>
        <div class="code-block">
            <p><strong>Fast Code [1.6419414936x faster, p03253, s968664754]</strong></p>
            <p class="diff-block-added">1. def&nbsp;prime_factorization(x):</p>
            <p class="diff-block-added">2. &nbsp;&nbsp;&nbsp;&nbsp;primes&nbsp;=&nbsp;[]</p>
            <p class="diff-block-added">3. &nbsp;&nbsp;&nbsp;&nbsp;_x&nbsp;=&nbsp;x</p>
            <p class="diff-block-added">4. &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(2,&nbsp;int(x**0.5)&nbsp;+&nbsp;1):</p>
            <p class="diff-block-added">5. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;_x&nbsp;%&nbsp;i&nbsp;==&nbsp;0:</p>
            <p class="diff-block-added">6. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;primes.append(i)</p>
            <p class="diff-block-added">7. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_x&nbsp;//=&nbsp;i</p>
            <p class="diff-block-added">8. &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;_x&nbsp;&gt;&nbsp;1:</p>
            <p class="diff-block-added">9. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;primes.append(_x)</p>
            <p class="diff-block-added">10. &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;primes</p>
            <p>11. </p>
            <p>12. </p>
            <p class="diff-block-added">13. def&nbsp;combination(n,&nbsp;r,&nbsp;mod=10**9&nbsp;+&nbsp;7):</p>
            <p class="diff-block-added">14. &nbsp;&nbsp;&nbsp;&nbsp;r&nbsp;=&nbsp;min(n&nbsp;-&nbsp;r,&nbsp;r)</p>
            <p class="diff-block-added">15. &nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;1</p>
            <p class="diff-block-added">16. &nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;i&nbsp;in&nbsp;range(r):</p>
            <p class="diff-block-added">17. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;res&nbsp;=&nbsp;res&nbsp;*&nbsp;(n&nbsp;-&nbsp;i)&nbsp;*&nbsp;pow(r&nbsp;-&nbsp;i,&nbsp;mod&nbsp;-&nbsp;2,&nbsp;mod)&nbsp;%&nbsp;mod</p>
            <p class="diff-block-added">18. &nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;res</p>
            <p>19. </p>
            <p>20. </p>
            <p class="diff-block-added">21. N,&nbsp;M&nbsp;=&nbsp;map(int,&nbsp;input().split())</p>
            <p class="diff-block-added">22. d&nbsp;=&nbsp;{}</p>
            <p class="diff-block-added">23. for&nbsp;p&nbsp;in&nbsp;prime_factorization(M):</p>
            <p class="diff-block-added">24. &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;p&nbsp;in&nbsp;d:</p>
            <p class="diff-block-added">25. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d[p]&nbsp;+=&nbsp;1</p>
            <p class="diff-block-added">26. &nbsp;&nbsp;&nbsp;&nbsp;else:</p>
            <p class="diff-block-added">27. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;d[p]&nbsp;=&nbsp;1</p>
            <p>28. ans&nbsp;=&nbsp;1</p>
            <p class="diff-block-added">29. for&nbsp;p&nbsp;in&nbsp;d:</p>
            <p class="diff-block-added">30. &nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;*=&nbsp;combination(d[p]&nbsp;+&nbsp;N&nbsp;-&nbsp;1,&nbsp;d[p])</p>
            <p class="diff-block-added">31. &nbsp;&nbsp;&nbsp;&nbsp;ans&nbsp;%=&nbsp;10**9&nbsp;+&nbsp;7</p>
            <p>32. print(ans)</p>
        </div>
    </div>
</body>
</html>